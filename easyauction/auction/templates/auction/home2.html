{% extends 'auction/base2.html' %}

{% block title %}Home{% endblock %}

{% block content %}
<v-row>
    <v-col>
        {% if hosted_auctions.exists %}
        <v-list>
            <v-subheader>My Auctions</v-subheader>
            {% for auction in hosted_auctions %}
            <v-list-item>
                <v-card href="{% url 'auction:auction_detail' pk=auction.pk %}">
                    <v-card-title>{{ auction.name }}</v-card-title>
                    <v-card-subtitle>{{ auction.time_created }}</v-card-subtitle>
                    <v-avatar class="ma-3" size="125" tile>
                        <v-img src="{{ auction.image.url }}"></v-img>
                    </v-avatar>
                </v-card>
            </v-list-item>
            {% endfor %}
        </v-list>
        {% else %}
        <v-list>
            <v-subheader>My Auctions</v-subheader>
            <v-list-item>
                <v-card href="{% url 'auction:create_auction' %}">
                    <v-card-title>No Auctions Created</v-card-title>
                    <v-card-subtitle>Click here to create an auction</v-card-subtitle>
                </v-card>
            </v-list-item>
        </v-list>
        {% endif %}
    </v-col>
    <v-col>
        <v-row justify="end">
            <v-col cols="4">
                {% if error_msg %}
                    <p style="color: red">{{ error_msg }}</p>
                {% endif %}
                <form id="join_form" method="POST">
                    {% csrf_token %}
                    <v-text-field
                        label="Join an auction"
                        placeholder="Enter auction code"
                        outlined
                        form="join_form"
                        name="auction_code"
                        type="number"
                        min="1"
                        step="1"
                    >
                    </v-text-field>
                </form>
            </v-col>
            <v-col>
                <v-btn form="join_form" type="submit">Submit</v-btn>
            </v-col>
        </v-row>
        {% if joined_auctions.exists %}
        <v-list>
            <v-subheader>Joined Auctions</v-subheader>
            {% for auction in joined_auctions %}
            <v-list-item>
                <v-card href="{% url 'auction:auction_detail' pk=auction.pk %}">
                    <v-card-title>{{ auction.name }}</v-card-title>
                    <v-card-subtitle>{{ auction.time_created }}</v-card-subtitle>
                </v-card>
            </v-list-item>
            {% endfor %}
        </v-list>
        {% else %}
        <v-list>
            <v-subheader>Joined Auctions</v-subheader>
            <v-list-item>
                <v-card href="{% url 'auction:enter_local_code' %}">
                    <v-card-title>No Auctions Joined</v-card-title>
                    <v-card-subtitle>Enter auction code here</v-card-subtitle>
                </v-card>
            </v-list-item>
        </v-list>
        {% endif %}
    </v-col>
</v-row>
{% endblock %}

{% block vue %}
    <script>
    Vue.use(Vuetify);

    home_vue = new Vue({
            el: '#app',
            vuetify: new Vuetify(),
            data: {
                drawer: false,
            },
            delimiters: ["[[", "]]"],
    });
    </script>
{% endblock %}